<!doctype html>
<html lang="">
<head>
    <meta charset="utf-8">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>lasvegas</title>

    <link rel="apple-touch-icon" href="apple-touch-icon.png">


</head>
<body>

<a id="result" href="" target="_blank"></a>


<script src="scripts/vendor/jquery.min.js"></script>
<script src="scripts/vendor/oauth-signature.js"></script>

<script>
    function rdmString()
    {
        var text = "";
        var possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";

        for( var i=0; i < 10; i++ )
            text += possible.charAt(Math.floor(Math.random() * possible.length));

        return text;
    }

    var YELP_BASE_URL = 'https://api.yelp.com/v2/search/';
    var YELP_CONSUMER_KEY = 'zcnTsN3e7uAwFARL9ABSgA';
    var YELP_TOKEN = 'Fv6FpQ6W1C_OY4q7IONE2DQuJw0Od332';
    var YELP_CONSUMER_SECRET = '1fhywusiXHcbUwAZFCEVLhupcPM';
    var YELP_TOKEN_SECRET = 'pRlpl-oXtzKKT53k2iiyke-9L90';

    var yelpURL = YELP_BASE_URL;

    var parameters = {
        oauth_consumer_key: YELP_CONSUMER_KEY,
        oauth_token: YELP_TOKEN,
        oauth_nonce: rdmString(),
        oauth_timestamp: Math.floor(Date.now()/1000),
        oauth_signature_method: 'HMAC-SHA1',
        oauth_version : '1.0',
        callback: 'yelpCallback'              // This is crucial to include for jsonp implementation in
                                    // AJAX or else the oauth-signature will be wrong.
    };

    parameters.term = 'Mission Pointe Condo in Silverado Ranch';
    parameters.location = '10245 S Maryland Pkwy, Las Vegas, 89183, United States of America';

    var encodedSignature = oauthSignature.generate('GET',yelpURL, parameters, YELP_CONSUMER_SECRET, YELP_TOKEN_SECRET);
    parameters.oauth_signature = encodedSignature;

    var settings = {
        url: yelpURL,
        data: parameters,
        cache: true,  //        <----  This is crucial to include as well to prevent jQuery from
        // adding on a cache-buster parameter "_=23489489749837",
        // invalidating our oauth-signature
        dataType: 'jsonp',
        jsonpCallback: 'yelpCallback',
        error: function(jqXHR, textStatus, errorThrown) {
            // Do stuff on fail
            console.log(jqXHR, textStatus, errorThrown);
            console.log('error');
        }
    };

    // Send AJAX request via jQuery library
    var jqxhr = $.ajax(settings);

    function yelpCallback (results) {
        console.log('inside yelpCallback');
        console.log(results);
    }
</script>

</body>
</html>
